# ğŸš€ LevisHub - Application Multi-Tenant avec Backoffice

## ğŸ“‹ **VUE D'ENSEMBLE DU PROJET**

**LevisHub** est une plateforme de dÃ©veloppement web freelance offrant des sites modernes, rapides et animÃ©s avec des backoffices sur mesure. L'application est conÃ§ue avec une architecture multi-tenant permettant aux clients d'avoir leur propre espace dÃ©diÃ©.

## ğŸ—ï¸ **ARCHITECTURE TECHNIQUE**

### **Stack Principal**
- **Frontend**: Next.js 14 avec App Router
- **Styling**: Tailwind CSS (site marketing) + CSS personnalisÃ© (backoffice)
- **Base de donnÃ©es**: Prisma ORM + SQLite (dev) â†’ PostgreSQL (production)
- **Authentification**: NextAuth.js avec rÃ´les ADMIN/CLIENT
- **Email**: Nodemailer pour les notifications
- **Paiements**: Stripe (prÃ©parÃ©, pas encore actif)

### **Structure des Dossiers**
```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ (marketing)/          # Site marketing principal (CTAs, pricing, landing)
â”‚   â”œâ”€â”€ (client)/            # Backoffice des clients
â”‚   â”œâ”€â”€ admin/               # Backoffice administrateur
â”‚   â””â”€â”€ api/                 # Routes API
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/                  # Composants UI rÃ©utilisables
â”‚   â””â”€â”€ auth/                # Composants d'authentification
â””â”€â”€ lib/                     # Utilitaires et configurations
```

## ğŸ¯ **FONCTIONNALITÃ‰S PRINCIPALES**

### **1. Site Marketing (/(marketing))**
- Landing pages avec animations
- SystÃ¨me de pricing
- Pages de services et portfolio
- Design moderne avec Tailwind CSS
- **IMPORTANT**: Ne jamais casser ce design existant

### **2. Backoffice Administrateur (/admin)**
- Gestion des clients et invitations
- Tableau de bord avec statistiques
- Gestion des tickets de support
- Profil, paramÃ¨tres et aide
- **Switch Mode Client**: Permet de tester l'interface client

### **3. Backoffice Client (/dashboard)**
- Tableau de bord personnalisÃ©
- CrÃ©ation et suivi des tickets
- Analytics et trafic du site
- Gestion des paiements et factures
- Profil et paramÃ¨tres

## ğŸ” **SYSTÃˆME D'AUTHENTIFICATION**

### **RÃ´les Utilisateurs**
- **ADMIN**: AccÃ¨s complet Ã  tous les backoffices
- **CLIENT**: AccÃ¨s uniquement Ã  son propre espace

### **SÃ©curitÃ©**
- Sessions gÃ©rÃ©es par NextAuth.js
- Protection des routes par rÃ´le
- Multi-tenancy stricte (chaque client voit seulement ses donnÃ©es)

## ğŸ“Š **SYSTÃˆME DE TICKETS**

### **FonctionnalitÃ©s**
- CrÃ©ation de tickets par les clients
- 4 niveaux de prioritÃ© (Faible, Moyenne, Ã‰levÃ©e, Urgente)
- 4 statuts (Ouvert, En cours, RÃ©solu, FermÃ©)
- Notifications email automatiques
- Gestion complÃ¨te cÃ´tÃ© admin

### **Workflow**
1. Client crÃ©e un ticket â†’ Email automatique Ã  l'admin
2. Admin met Ã  jour le statut â†’ Email automatique au client
3. Suivi complet de l'historique

## ğŸ¨ **SYSTÃˆME DE DESIGN**

### **Marketing Site**
- **Tailwind CSS** uniquement
- Design existant Ã  prÃ©server
- Animations et composants modernes

### **Backoffice**
- **CSS personnalisÃ©** dans `src/components/ui/backoffice/backoffice-dark.css`
- ThÃ¨me sombre moderne et professionnel
- **COMPLÃˆTEMENT SÃ‰PARÃ‰** du site marketing
- Composants dans `BackofficeLayoutDark.tsx`

## ğŸ—„ï¸ **BASE DE DONNÃ‰ES**

### **ModÃ¨les Principaux**
```prisma
User (ADMIN/CLIENT + clientId pour multi-tenancy)
Client (informations entreprise)
Ticket (support avec statuts et prioritÃ©s)
Subscription (abonnements Stripe)
Invoice (factures)
AnalyticsEvent (suivi du trafic)
```

### **Migration**
- **Actuel**: SQLite (dÃ©veloppement)
- **Futur**: PostgreSQL sur Vercel
- **PrÃ©parer**: Scripts de migration

## ğŸš§ **FONCTIONNALITÃ‰S EN DÃ‰VELOPPEMENT**

### **ImmÃ©diat (PrioritÃ© 1)**
- âœ… SystÃ¨me de tickets (TERMINÃ‰)
- ğŸ”„ Configuration SMTP Gmail
- ğŸ”„ Tests des notifications email

### **Court terme (PrioritÃ© 2)**
- ğŸ“Š Dashboard analytics pour clients
- ğŸ’³ IntÃ©gration Stripe complÃ¨te
- ğŸ“§ SystÃ¨me d'invitations par email
- ğŸ” Recherche globale

### **Moyen terme (PrioritÃ© 3)**
- ğŸ“± Application mobile
- ğŸ”” Notifications push
- ğŸ“ˆ Rapports avancÃ©s
- ğŸŒ Multi-langues

## âš ï¸ **RÃˆGLES IMPORTANTES Ã€ RESPECTER**

### **1. SÃ©paration des Designs**
- **JAMAIS** mÃ©langer Tailwind (marketing) et CSS personnalisÃ© (backoffice)
- Le backoffice doit rester complÃ¨tement externe
- Utiliser `BackofficeLayoutDark` pour tous les backoffices

### **2. Multi-Tenancy**
- **TOUJOURS** vÃ©rifier les permissions par rÃ´le
- Un client ne doit **JAMAIS** voir les donnÃ©es d'un autre
- Utiliser `session.user.role` et `session.user.clientId`

### **3. Composants**
- **Server Components** par dÃ©faut
- **"use client"** seulement si nÃ©cessaire (useState, useEffect, etc.)
- Extraire la logique client dans des composants sÃ©parÃ©s

### **4. API Routes**
- **TOUJOURS** vÃ©rifier l'authentification
- Validation des donnÃ©es cÃ´tÃ© serveur
- Gestion d'erreurs appropriÃ©e

## ğŸ”§ **CONFIGURATION ENVIRONNEMENT**

### **Variables Requises**
```env
# SMTP (Gmail)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=quentinlevis@gmail.com
SMTP_PASS=mot_de_passe_application

# NextAuth
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=secret_unique

# Base de donnÃ©es
DATABASE_URL="file:./dev.db"
```

### **Gmail Setup**
1. Activer l'authentification Ã  2 facteurs
2. CrÃ©er un mot de passe d'application
3. Utiliser ce mot de passe dans SMTP_PASS

## ğŸ“± **WORKFLOW UTILISATEUR**

### **Administrateur**
1. Se connecte â†’ `/admin`
2. GÃ¨re les clients et invitations
3. Traite les tickets de support
4. AccÃ¨de aux statistiques globales

### **Client**
1. ReÃ§oit une invitation par email
2. CrÃ©e son compte et mot de passe
3. AccÃ¨de Ã  son dashboard â†’ `/dashboard`
4. CrÃ©e des tickets et suit ses projets

## ğŸ¯ **OBJECTIFS FUTURS**

### **Phase 1: Consolidation**
- Finaliser le systÃ¨me de tickets
- ImplÃ©menter les analytics de base
- Tester et optimiser les performances

### **Phase 2: Expansion**
- IntÃ©gration Stripe complÃ¨te
- SystÃ¨me de facturation automatique
- API publique pour les dÃ©veloppeurs

### **Phase 3: Ã‰volution**
- Application mobile native
- Intelligence artificielle pour le support
- Marketplace de composants

## ğŸ› **DÃ‰PANNAGE COMMUN**

### **Erreurs FrÃ©quentes**
1. **"React Context unavailable"** â†’ Utiliser `SessionWrapper` dans le layout racine
2. **"useState in Server Component"** â†’ Extraire dans un composant client sÃ©parÃ©
3. **"Module not found"** â†’ VÃ©rifier les imports et la structure des dossiers

### **Bonnes Pratiques**
- Toujours tester les deux rÃ´les (ADMIN/CLIENT)
- VÃ©rifier la multi-tenancy sur chaque nouvelle fonctionnalitÃ©
- Maintenir la sÃ©paration des designs
- Documenter les nouvelles API

## ğŸ“š **RESSOURCES UTILES**

- **Prisma**: https://prisma.io/docs
- **NextAuth**: https://next-auth.js.org
- **Stripe**: https://stripe.com/docs
- **Tailwind**: https://tailwindcss.com/docs

---

**ğŸ’¡ Conseil**: Avant de commencer une nouvelle fonctionnalitÃ©, lire ce fichier et comprendre le contexte global de l'application. Le systÃ¨me est conÃ§u pour Ãªtre robuste et scalable, respectez l'architecture existante.
